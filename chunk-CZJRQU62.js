import{a as Te}from"./chunk-NQL5HIXM.js";import{a as Fe,b as $e}from"./chunk-JFFEMBUM.js";import{c as ie}from"./chunk-NAZHZL2Z.js";import{a as Ve}from"./chunk-5FD5A6TW.js";import{a as F,b as ve,d as _e,e as ye,f as z,g as Ee,h as G,j as Ce,k as Se,l as we}from"./chunk-VAUZXUCP.js";import{b as ne,c as _,d as re,e as oe,g as ae,h as le,i as de,j as se,k as ce,l as ue,m as me,n as pe,o as he,p as ge,r as xe,s as fe,t as be}from"./chunk-JJK6J4PC.js";import"./chunk-ERIR3R6Y.js";import{A as U,Ia as l,Ib as o,Jb as I,Kb as v,O,Qb as R,Sa as M,Vb as y,Wa as Y,Wb as N,Xb as D,_a as C,a as B,aa as Q,b as P,db as J,ea as W,jb as m,k as T,ka as w,kb as n,la as V,lb as t,ma as q,mb as S,na as j,tb as A,tc as K,ub as h,uc as X,wb as g,wc as Z,xc as ee,yc as te,z as H}from"./chunk-JV3ZGQQZ.js";var De=(()=>{let c=class c{constructor(e){this.firestore=e}getExitVouchers(){let e=z(this.firestore,"exitVouchers"),r=Se(e,Ce("date","desc"));return _e(r,{idField:"id"})}addExitVoucher(e){let r=z(this.firestore,"exitVouchers");return ye(r,P(B({},e),{createdAt:F.now()})).then(()=>{})}updateExitVoucher(e,r){let i=G(this.firestore,"exitVouchers",e);return we(i,r)}deleteExitVoucher(e){let r=G(this.firestore,"exitVouchers",e);return Ee(r)}generateVoucherNumber(){let e=new Date,r=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0"),p=Math.floor(Math.random()*1e3).toString().padStart(3,"0");return`SRT-${r}${i}${s}-${p}`}};c.\u0275fac=function(r){return new(r||c)(W(ve))},c.\u0275prov=Q({token:c,factory:c.\u0275fac,providedIn:"root"});let d=c;return d})();var Me=()=>[];function Be(d,c){if(d&1){let a=A();n(0,"div",29)(1,"strong"),o(2,"Erreur :"),t(),o(3),n(4,"button",30),h("click",function(){w(a);let r=g();return V(r.errorMessage="")}),o(5,"\xD7"),t()()}if(d&2){let a=g();l(3),v(" ",a.errorMessage," ")}}function Pe(d,c){d&1&&(n(0,"span"),o(1,"+ Ajouter Bon"),t())}function Le(d,c){d&1&&(n(0,"span"),o(1,"Fermer"),t())}function Oe(d,c){if(d&1&&(n(0,"option",63),o(1),t()),d&2){let a=c.$implicit;m("value",a.id),l(),I(a.name)}}function qe(d,c){if(d&1){let a=A();n(0,"div",50)(1,"div",51)(2,"label",52),o(3,"Produit *"),t(),n(4,"select",53)(5,"option",54),o(6,"-- S\xE9lectionnez --"),t(),C(7,Oe,2,2,"option",55),y(8,"async"),t()(),n(9,"div",56)(10,"label",52),o(11,"Quantit\xE9 *"),t(),S(12,"input",57),t(),n(13,"div",56)(14,"label",52),o(15,"Prix Unit. (DT) *"),t(),S(16,"input",58),t(),n(17,"div",56)(18,"label",52),o(19,"Sous-total"),t(),S(20,"input",59),y(21,"number"),t(),n(22,"div",60)(23,"button",61),h("click",function(){w(a);let r=g(2);return V(r.addProductLine())}),o(24,"+"),t(),n(25,"button",62),h("click",function(){let r=w(a).index,i=g(2);return V(i.removeProductLine(r))}),o(26,"-"),t()()()}if(d&2){let a=c.index,e=g(2);m("formGroupName",a),l(7),m("ngForOf",N(8,4,e.products$)),l(13),m("value",D(21,6,e.calculateSubtotal(a),"1.2-2")),l(5),m("disabled",e.productsFormArray.length===1)}}function je(d,c){d&1&&(n(0,"span"),o(1,"Enregistrement..."),t())}function Re(d,c){if(d&1&&(n(0,"span"),o(1),t()),d&2){let a=g(2);l(),I(a.isEditing?"Mettre \xE0 jour":"Cr\xE9er Bon")}}function ze(d,c){if(d&1){let a=A();n(0,"div",31)(1,"h2",32),o(2),t(),n(3,"form",33),h("ngSubmit",function(){w(a);let r=g();return V(r.onSubmit())}),n(4,"div",15)(5,"div")(6,"label",34),o(7,"N\xB0 Bon *"),t(),S(8,"input",35),t(),n(9,"div")(10,"label",34),o(11,"Date *"),t(),S(12,"input",36),t(),n(13,"div")(14,"label",34),o(15,"Client *"),t(),S(16,"ng-select",37),y(17,"async"),t(),n(18,"div")(19,"label",34),o(20,"Destination"),t(),S(21,"input",38),t()(),n(22,"div",39)(23,"h3",40),o(24,"Produits"),t(),n(25,"div",41),C(26,qe,27,9,"div",42),t(),n(27,"div",43)(28,"div",44)(29,"span"),o(30,"Total :"),t(),n(31,"span",45),o(32),y(33,"number"),t()()()(),n(34,"div")(35,"label",34),o(36,"Notes"),t(),S(37,"textarea",46),t(),n(38,"div",47)(39,"button",48),C(40,je,2,0,"span",10)(41,Re,2,1,"span",10),t(),n(42,"button",49),h("click",function(){w(a);let r=g();return V(r.resetForm())}),o(43,"Annuler"),t()()()()}if(d&2){let a=g();l(2),v("",a.isEditing?"Modifier":"Nouveau"," Bon de Sortie"),l(),m("formGroup",a.voucherForm),l(13),m("items",N(17,10,a.customers$)??R(15,Me))("searchable",!0)("clearable",!0),l(10),m("ngForOf",a.productsFormArray.controls),l(6),v("",D(33,12,a.calculateTotal(),"1.2-2")," DT"),l(7),m("disabled",a.isLoading||a.voucherForm.invalid),l(),m("ngIf",a.isLoading),l(),m("ngIf",!a.isLoading)}}function Ge(d,c){if(d&1&&(n(0,"tr",84)(1,"td",85),o(2),t(),n(3,"td",85),o(4),t(),n(5,"td",85),o(6),y(7,"number"),t(),n(8,"td",86),o(9),y(10,"number"),t()()),d&2){let a=c.$implicit;l(2),I(a.productName),l(2),I(a.quantity),l(2),v("",D(7,4,a.unitPrice,"1.2-2")," DT"),l(3),v("",D(10,7,a.subtotal,"1.2-2")," DT")}}function He(d,c){if(d&1){let a=A();n(0,"div",72)(1,"table",73)(2,"thead",74)(3,"tr")(4,"th",75),o(5,"Produit"),t(),n(6,"th",75),o(7,"Quantit\xE9"),t(),n(8,"th",75),o(9,"Prix Unit."),t(),n(10,"th",75),o(11,"Sous-total"),t()()(),n(12,"tbody"),C(13,Ge,11,10,"tr",76),n(14,"tr",77)(15,"td",78),o(16,"Total :"),t(),n(17,"td",79),o(18),y(19,"number"),t()()()(),n(20,"div",80)(21,"button",81),h("click",function(){w(a);let r=g().$implicit,i=g(2);return V(i.editVoucher(r))}),o(22,"Modifier"),t(),n(23,"button",82),h("click",function(){w(a);let r=g().$implicit,i=g(2);return V(i.deleteVoucher(r.id,r.voucherNumber))}),o(24,"Supprimer"),t(),n(25,"button",83),h("click",function(){w(a);let r=g().$implicit,i=g(2);return V(i.printItem(r))}),o(26,"Imprimer ce Bon"),t()()()}if(d&2){let a=g().$implicit;l(13),m("ngForOf",a.products),l(5),v("",D(19,2,a.totalAmount,"1.2-2")," DT")}}function Ue(d,c){if(d&1){let a=A();n(0,"div",67)(1,"div",68),h("click",function(){let r=w(a).$implicit,i=g(2);return V(i.toggleExpand(r.id))}),n(2,"div",69)(3,"div")(4,"strong"),o(5,"N\xB0 :"),t(),o(6),t(),n(7,"div")(8,"strong"),o(9,"Date:"),t(),o(10),t(),n(11,"div")(12,"strong"),o(13,"Client:"),t(),o(14),t(),n(15,"div")(16,"strong"),o(17,"Total:"),t(),o(18),y(19,"number"),t()(),n(20,"button",70),o(21),t()(),C(22,He,27,5,"div",71),t()}if(d&2){let a=c.$implicit,e=g(2);J("data-id",a.id),l(6),v(" ",a.voucherNumber),l(4),v(" ",e.formatDate(a.date)),l(4),v(" ",a.customer),l(4),v(" ",D(19,7,a.totalAmount,"1.2-2")," DT"),l(3),I(e.expandedVoucherId===a.id?"\u25BC":"\u25BA"),l(),m("ngIf",e.expandedVoucherId===a.id)}}function Qe(d,c){d&1&&(n(0,"div",87),o(1," Aucun bon trouv\xE9. "),t())}function We(d,c){if(d&1&&(n(0,"div",64),C(1,Ue,23,10,"div",65),y(2,"async"),C(3,Qe,2,0,"div",66),y(4,"async"),t()),d&2){let a,e=g();l(),m("ngForOf",N(2,2,e.filteredVouchers$)),l(2),m("ngIf",((a=N(4,4,e.filteredVouchers$))==null?null:a.length)===0)}}var ut=(()=>{let c=class c{constructor(e,r,i,s,p){this.vouchersService=e,this.productsService=r,this.customersService=i,this.fb=s,this.router=p,this.isLoading=!1,this.isEditing=!1,this.editingId=null,this.errorMessage="",this.showForm=!1,this.expandedVoucherId=null,this.searchTerm="",this.searchTerm$=new T(""),this.selectedCustomer=null,this.selectedCustomer$=new T(null),this.dateFrom=null,this.dateFrom$=new T(null),this.dateTo=null,this.dateTo$=new T(null),this.minAmount=null,this.minAmount$=new T(null),this.maxAmount=null,this.maxAmount$=new T(null),this.sortBy="date",this.sortBy$=new T("date"),this.sortOrder="desc",this.sortOrder$=new T("desc");let b=new Date().toISOString().split("T")[0];this.voucherForm=this.fb.group({voucherNumber:[this.vouchersService.generateVoucherNumber(),_.required],date:[b,_.required],customer:["",_.required],destination:[""],products:this.fb.array([this.createProductLine()]),notes:[""]})}ngOnInit(){this.loadVouchers(),this.products$=this.productsService.getProducts(),this.customers$=this.customersService.getCustomers(),this.filteredVouchers$=U([this.vouchers$,this.searchTerm$,this.selectedCustomer$,this.dateFrom$,this.dateTo$,this.minAmount$,this.maxAmount$,this.sortBy$,this.sortOrder$]).pipe(H(([e,r,i,s,p,b,E,k,L])=>{let f=e;if(r&&(f=f.filter(u=>u.voucherNumber.toLowerCase().includes(r.toLowerCase()))),i&&(f=f.filter(u=>u.customer===i)),s){let u=new Date(s);f=f.filter(x=>(x.date instanceof F?x.date.toDate():new Date(x.date))>=u)}if(p){let u=new Date(p);u.setHours(23,59,59),f=f.filter(x=>(x.date instanceof F?x.date.toDate():new Date(x.date))<=u)}return b!==null&&(f=f.filter(u=>(u.totalAmount||0)>=b)),E!==null&&(f=f.filter(u=>(u.totalAmount||0)<=E)),f=f.sort((u,x)=>{let $=0;if(k==="date"){let Ae=u.date instanceof F?u.date.toDate().getTime():new Date(u.date).getTime(),Ie=x.date instanceof F?x.date.toDate().getTime():new Date(x.date).getTime();$=Ae-Ie}else k==="customer"?$=u.customer.localeCompare(x.customer):k==="amount"&&($=(u.totalAmount||0)-(x.totalAmount||0));return L==="asc"?$:-$}),f}))}get productsFormArray(){return this.voucherForm.get("products")}createProductLine(){return this.fb.group({productId:["",_.required],quantity:[1,[_.required,_.min(1)]],unitPrice:[0,[_.required,_.min(.01)]]})}addProductLine(){this.productsFormArray.push(this.createProductLine())}removeProductLine(e){this.productsFormArray.length>1&&this.productsFormArray.removeAt(e)}calculateSubtotal(e){let r=this.productsFormArray.at(e).value;return(r.quantity||0)*(r.unitPrice||0)}calculateTotal(){return this.productsFormArray.controls.reduce((e,r)=>{let i=r.value;return e+(i.quantity||0)*(i.unitPrice||0)},0)}loadVouchers(){this.vouchers$=this.vouchersService.getExitVouchers()}onSearchChange(e){this.searchTerm=e,this.searchTerm$.next(e)}onCustomerFilterChange(e){this.selectedCustomer=e,this.selectedCustomer$.next(e)}onDateFromChange(e){this.dateFrom=e,this.dateFrom$.next(e)}onDateToChange(e){this.dateTo=e,this.dateTo$.next(e)}onMinAmountChange(e){this.minAmount=e,this.minAmount$.next(e)}onMaxAmountChange(e){this.maxAmount=e,this.maxAmount$.next(e)}onSortChange(e){this.sortBy===e?this.sortOrder=this.sortOrder==="asc"?"desc":"asc":(this.sortBy=e,this.sortOrder=this.sortBy==="date"?"desc":"asc"),this.sortBy$.next(this.sortBy),this.sortOrder$.next(this.sortOrder)}clearFilters(){this.searchTerm="",this.searchTerm$.next(""),this.selectedCustomer=null,this.selectedCustomer$.next(null),this.dateFrom=null,this.dateFrom$.next(null),this.dateTo=null,this.dateTo$.next(null),this.minAmount=null,this.minAmount$.next(null),this.maxAmount=null,this.maxAmount$.next(null),this.sortBy="date",this.sortBy$.next("date"),this.sortOrder="desc",this.sortOrder$.next("desc")}onSubmit(){if(this.voucherForm.invalid){this.errorMessage="Veuillez remplir tous les champs obligatoires.";return}this.isLoading=!0,this.errorMessage="";let e=this.voucherForm.value,r=e.products.map(s=>P(B({},s),{productName:this.getProductName(s.productId),subtotal:s.quantity*s.unitPrice})),i={voucherNumber:e.voucherNumber,date:F.fromDate(new Date(e.date)),customer:e.customer,destination:e.destination,products:r,totalAmount:this.calculateTotal(),notes:e.notes};this.isEditing&&this.editingId?this.vouchersService.updateExitVoucher(this.editingId,i).then(()=>{this.resetForm(),this.loadVouchers()}).catch(s=>{this.errorMessage="Erreur lors de la modification.",console.error(s)}).finally(()=>this.isLoading=!1):this.vouchersService.addExitVoucher(i).then(()=>{this.resetForm(),this.loadVouchers()}).catch(s=>{this.errorMessage="Erreur lors de l'ajout.",console.error(s)}).finally(()=>this.isLoading=!1)}editVoucher(e){this.isEditing=!0,this.editingId=e.id||null;let r=e.date.toDate().toISOString().split("T")[0];this.productsFormArray.clear(),e.products.forEach(i=>{this.productsFormArray.push(this.fb.group({productId:[i.productId,_.required],quantity:[i.quantity,[_.required,_.min(1)]],unitPrice:[i.unitPrice,[_.required,_.min(.01)]]}))}),this.voucherForm.patchValue({voucherNumber:e.voucherNumber,date:r,customer:e.customer,destination:e.destination,notes:e.notes}),this.showForm=!0,window.scrollTo({top:0,behavior:"smooth"})}deleteVoucher(e,r){confirm(`Supprimer le bon "${r}" ?`)&&(this.isLoading=!0,this.vouchersService.deleteExitVoucher(e).then(()=>{this.loadVouchers()}).catch(i=>{this.errorMessage="Erreur lors de la suppression.",console.error(i)}).finally(()=>this.isLoading=!1))}resetForm(){this.productsFormArray.clear(),this.productsFormArray.push(this.createProductLine());let e=new Date().toISOString().split("T")[0];this.voucherForm.patchValue({voucherNumber:this.vouchersService.generateVoucherNumber(),date:e,customer:"",destination:"",notes:""}),this.isEditing=!1,this.editingId=null,this.errorMessage="",this.showForm=!1}toggleForm(){this.showForm=!this.showForm,this.showForm||this.resetForm()}toggleExpand(e){this.expandedVoucherId=this.expandedVoucherId===e?null:e}getProductName(e){let r="";return this.products$.subscribe(i=>{let s=i.find(p=>p.id===e);r=s?s.name:"Produit inconnu"}),r}formatDate(e){return e instanceof F?e.toDate().toLocaleDateString("fr-FR"):new Date(e).toLocaleDateString("fr-FR")}printList(){this.filteredVouchers$.pipe(O(1)).subscribe(e=>{if(e.length===0){alert("Aucun bon \xE0 imprimer.");return}this.generatePrintHTML(e)})}generatePrintHTML(e){let r=window.open("","_blank","width=900,height=700");if(!r){alert("\u274C Popup bloqu\xE9e !");return}let i=new Date().toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),s=e.length,p=e.reduce((u,x)=>u+(x.totalAmount||0),0),b=e.reduce((u,x)=>u+x.products.length,0),E=[];this.searchTerm&&E.push(`Recherche: "${this.searchTerm}"`),this.selectedCustomer&&E.push(`Client: ${this.selectedCustomer}`),this.dateFrom&&E.push(`Date D\xE9but: ${new Date(this.dateFrom).toLocaleDateString("fr-FR")}`),this.dateTo&&E.push(`Date Fin: ${new Date(this.dateTo).toLocaleDateString("fr-FR")}`),this.minAmount!==null&&E.push(`Montant Min: ${this.minAmount} DT`),this.maxAmount!==null&&E.push(`Montant Max: ${this.maxAmount} DT`);let k={date:"Date",customer:"Client",amount:"Montant"};E.push(`Tri: ${k[this.sortBy]} (${this.sortOrder==="asc"?"\u2191":"\u2193"})`);let L=e.map((u,x)=>`
      <tr>
        <td>${x+1}</td>
        <td>${u.voucherNumber}</td>
        <td>${this.formatDate(u.date)}</td>
        <td>${u.customer}</td>
        <td>${u.products.length}</td>
        <td>${(u.totalAmount||0).toFixed(2)} DT</td>
      </tr>
    `).join(""),f=`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="UTF-8">
        <title>Liste Bons de Sortie - ${i}</title>
        <style>
          @page { margin: 15mm; size: A4 landscape; }
          body { font-family: Arial, sans-serif; margin: 0; padding: 15px; font-size: 10pt; }
          .header { text-align: center; margin-bottom: 15px; border-bottom: 2px solid #dc2626; padding-bottom: 10px; }
          .header h1 { font-size: 20pt; color: #dc2626; margin: 0 0 5px 0; }
          .filters { background: #fef2f2; padding: 8px; margin-bottom: 12px; border-left: 3px solid #dc2626; }
          .filters h3 { font-size: 11pt; margin: 0 0 5px 0; }
          .filters ul { list-style: none; padding: 0; margin: 0; }
          .filters li { font-size: 9pt; margin: 2px 0; }
          .stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-bottom: 15px; }
          .stat { background: #f9fafb; border: 1px solid #e5e7eb; padding: 8px; text-align: center; }
          .stat .label { font-size: 8pt; color: #666; }
          .stat .value { font-size: 14pt; font-weight: bold; color: #dc2626; }
          table { width: 100%; border-collapse: collapse; }
          thead { background: #dc2626; color: white; }
          th, td { padding: 6px 8px; text-align: left; border: 1px solid #ddd; font-size: 9pt; }
          tbody tr:nth-child(even) { background: #f9fafb; }
          tfoot { background: #fef2f2; font-weight: bold; }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>\u{1F4E4} Bons de Sortie - Liste</h1>
          <p>Date d'impression : ${i}</p>
        </div>
        <div class="filters">
          <h3>Filtres Appliqu\xE9s</h3>
          <ul>${E.map(u=>`<li>\u2022 ${u}</li>`).join("")}</ul>
        </div>
        <div class="stats">
          <div class="stat"><div class="label">Total Bons</div><div class="value">${s}</div></div>
          <div class="stat"><div class="label">Total Produits</div><div class="value">${b}</div></div>
          <div class="stat"><div class="label">Montant Total</div><div class="value">${p.toFixed(2)} DT</div></div>
        </div>
        <table>
          <thead>
            <tr><th>#</th><th>N\xB0 Bon</th><th>Date</th><th>Client</th><th>Produits</th><th>Montant</th></tr>
          </thead>
          <tbody>${L}</tbody>
          <tfoot>
            <tr><td colspan="4">TOTAL (${s} bons)</td><td>${b}</td><td>${p.toFixed(2)} DT</td></tr>
          </tfoot>
        </table>
      </body>
      </html>
    `;r.document.write(f),r.document.close(),r.focus(),setTimeout(()=>r.print(),500)}printItem(e){this.filteredVouchers$.pipe(O(1)).subscribe(r=>{let i=r.find(b=>b.id===e.id);if(!i)return;let s=window.open("","_blank","width=800,height=600");if(!s)return;let p=`
        <!DOCTYPE html>
        <html>
        <head>
          <meta charset="UTF-8">
          <title>Bon de Sortie ${i.voucherNumber}</title>
          <style>
            body { font-family: Arial, sans-serif; padding: 20px; }
            h1 { text-align: center; border-bottom: 2px solid #000; }
            table { width: 100%; border-collapse: collapse; margin: 15px 0; }
            th, td { padding: 8px; border: 1px solid #ddd; }
            th { background: #f3f4f6; }
          </style>
        </head>
        <body>
          <h1>Bon de Sortie N\xB0 ${i.voucherNumber}</h1>
          <table>
            <tr><th>Date</th><td>${this.formatDate(i.date)}</td></tr>
            <tr><th>Client</th><td>${i.customer}</td></tr>
            ${i.destination?`<tr><th>Destination</th><td>${i.destination}</td></tr>`:""}
          </table>
          <h3>Produits</h3>
          <table>
            <thead>
              <tr><th>Produit</th><th>Quantit\xE9</th><th>Prix Unit.</th><th>Sous-total</th></tr>
            </thead>
            <tbody>
              ${i.products.map(b=>`
                <tr>
                  <td>${b.productName}</td>
                  <td>${b.quantity}</td>
                  <td>${b.unitPrice.toFixed(2)} DT</td>
                  <td>${b.subtotal.toFixed(2)} DT</td>
                </tr>
              `).join("")}
            </tbody>
            <tfoot>
              <tr><th colspan="3">Total</th><th>${(i.totalAmount||0).toFixed(2)} DT</th></tr>
            </tfoot>
          </table>
        </body>
        </html>
      `;s.document.write(p),s.document.close(),setTimeout(()=>{s.print(),s.close()},250)})}};c.\u0275fac=function(r){return new(r||c)(M(De),M(Ve),M(Te),M(xe),M(ie))},c.\u0275cmp=Y({type:c,selectors:[["app-exit-voucher"]],decls:57,vars:20,consts:[[1,"container","mx-auto","px-4","py-8"],[1,"text-3xl","font-bold","text-gray-800","mb-6"],["class","bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",4,"ngIf"],[1,"flex","flex-col","md:flex-row","justify-between","items-center","mb-4","gap-4"],["type","text","placeholder","\u{1F50D} Rechercher par num\xE9ro bon...",1,"w-full","md:w-1/3","px-4","py-2","border","rounded-lg",3,"ngModelChange","ngModel"],[1,"flex","gap-2"],[1,"bg-purple-600","hover:bg-purple-700","text-white","font-bold","py-2","px-6","rounded-lg","flex","items-center","space-x-2","no-print",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"],[1,"bg-green-600","hover:bg-green-700","text-white","font-bold","py-2","px-6","rounded-lg","no-print",3,"click"],[4,"ngIf"],[1,"bg-white","shadow-md","rounded-lg","p-4","mb-6","no-print"],[1,"text-lg","font-semibold","mb-3","flex","items-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],["bindLabel","name","bindValue","name","placeholder","Tous",1,"w-full",3,"ngModelChange","ngModel","items","clearable"],["type","date",1,"w-full","px-3","py-2","border","rounded-lg",3,"ngModelChange","ngModel"],[1,"w-full","px-3","py-2","border","rounded-lg",3,"ngModelChange","ngModel"],["value","date"],["value","customer"],["value","amount"],["type","number","placeholder","0",1,"w-full","px-3","py-2","border","rounded-lg",3,"ngModelChange","ngModel"],["type","number","placeholder","10000",1,"w-full","px-3","py-2","border","rounded-lg",3,"ngModelChange","ngModel"],[1,"mt-4"],[1,"bg-gray-500","hover:bg-gray-600","text-white","px-4","py-2","rounded-lg",3,"click"],["class","bg-white shadow-md rounded-lg p-6 mb-6 no-print",4,"ngIf"],["class","space-y-4",4,"ngIf"],[1,"bg-red-100","border","border-red-400","text-red-700","px-4","py-3","rounded","mb-4"],[1,"float-right",3,"click"],[1,"bg-white","shadow-md","rounded-lg","p-6","mb-6","no-print"],[1,"text-2xl","font-semibold","mb-4"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"block","text-gray-700","font-medium","mb-2"],["formControlName","voucherNumber","type","text","readonly","",1,"w-full","px-4","py-2","border","rounded-lg","bg-gray-100"],["formControlName","date","type","date",1,"w-full","px-4","py-2","border","rounded-lg"],["formControlName","customer","bindLabel","name","bindValue","name","placeholder","-- S\xE9lectionnez --",1,"w-full",3,"items","searchable","clearable"],["formControlName","destination","type","text",1,"w-full","px-4","py-2","border","rounded-lg"],[1,"border-t","pt-4"],[1,"text-lg","font-semibold","mb-3"],["formArrayName","products",1,"space-y-3"],["class","grid grid-cols-1 md:grid-cols-12 gap-3 items-end bg-gray-50 p-3 rounded",3,"formGroupName",4,"ngFor","ngForOf"],[1,"mt-4","bg-red-50","p-4","rounded"],[1,"flex","justify-between","text-xl","font-bold"],[1,"text-red-600"],["formControlName","notes","rows","2",1,"w-full","px-4","py-2","border","rounded-lg"],[1,"flex","gap-4"],["type","submit",1,"bg-red-600","hover:bg-red-700","text-white","font-bold","py-2","px-6","rounded-lg","disabled:bg-gray-400",3,"disabled"],["type","button",1,"bg-gray-500","hover:bg-gray-600","text-white","font-bold","py-2","px-6","rounded-lg",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-12","gap-3","items-end","bg-gray-50","p-3","rounded",3,"formGroupName"],[1,"md:col-span-4"],[1,"block","text-sm","text-gray-600","mb-1"],["formControlName","productId",1,"w-full","px-3","py-2","border","rounded"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"md:col-span-2"],["formControlName","quantity","type","number",1,"w-full","px-3","py-2","border","rounded"],["formControlName","unitPrice","type","number","step","0.01",1,"w-full","px-3","py-2","border","rounded"],["readonly","",1,"w-full","px-3","py-2","border","rounded","bg-gray-100",3,"value"],[1,"md:col-span-2","flex","gap-2"],["type","button",1,"bg-blue-500","text-white","px-3","py-2","rounded",3,"click"],["type","button",1,"bg-red-500","text-white","px-3","py-2","rounded","disabled:bg-gray-300",3,"click","disabled"],[3,"value"],[1,"space-y-4"],["class","bg-white shadow rounded-lg overflow-hidden voucher-card",4,"ngFor","ngForOf"],["class","text-center py-8 text-gray-500",4,"ngIf"],[1,"bg-white","shadow","rounded-lg","overflow-hidden","voucher-card"],[1,"px-6","py-4","flex","justify-between","items-center","cursor-pointer","hover:bg-gray-50",3,"click"],[1,"flex-1","grid","grid-cols-4","gap-4"],[1,"text-red-600","no-print"],["class","px-6 py-4 bg-gray-50 border-t",4,"ngIf"],[1,"px-6","py-4","bg-gray-50","border-t"],[1,"min-w-full"],[1,"bg-gray-100"],[1,"px-4","py-2","text-left","text-sm"],["class","border-t",4,"ngFor","ngForOf"],[1,"bg-red-50","font-bold"],["colspan","3",1,"px-4","py-2","text-right"],[1,"px-4","py-2","text-red-600"],[1,"mt-4","flex","gap-2","no-print"],[1,"bg-indigo-600","hover:bg-indigo-700","text-white","px-4","py-2","rounded",3,"click"],[1,"bg-red-600","hover:bg-red-700","text-white","px-4","py-2","rounded",3,"click"],[1,"bg-purple-600","hover:bg-purple-700","text-white","px-4","py-2","rounded",3,"click"],[1,"border-t"],[1,"px-4","py-2"],[1,"px-4","py-2","font-semibold"],[1,"text-center","py-8","text-gray-500"]],template:function(r,i){r&1&&(n(0,"div",0)(1,"h1",1),o(2,"Bons de Sortie (Multi-Produits)"),t(),C(3,Be,6,1,"div",2),n(4,"div",3)(5,"input",4),h("ngModelChange",function(p){return i.onSearchChange(p)}),t(),n(6,"div",5)(7,"button",6),h("click",function(){return i.printList()}),q(),n(8,"svg",7),S(9,"path",8),t(),j(),n(10,"span"),o(11,"Imprimer Liste"),t()(),n(12,"button",9),h("click",function(){return i.toggleForm()}),C(13,Pe,2,0,"span",10)(14,Le,2,0,"span",10),t()()(),n(15,"div",11)(16,"h3",12),q(),n(17,"svg",13),S(18,"path",14),t(),o(19," Filtres Avanc\xE9s "),t(),j(),n(20,"div",15)(21,"div")(22,"label",16),o(23,"Client"),t(),n(24,"ng-select",17),y(25,"async"),h("ngModelChange",function(p){return i.onCustomerFilterChange(p)}),t()(),n(26,"div")(27,"label",16),o(28,"Date D\xE9but"),t(),n(29,"input",18),h("ngModelChange",function(p){return i.onDateFromChange(p)}),t()(),n(30,"div")(31,"label",16),o(32,"Date Fin"),t(),n(33,"input",18),h("ngModelChange",function(p){return i.onDateToChange(p)}),t()(),n(34,"div")(35,"label",16),o(36,"Trier par"),t(),n(37,"select",19),h("ngModelChange",function(p){return i.onSortChange(p)}),n(38,"option",20),o(39),t(),n(40,"option",21),o(41),t(),n(42,"option",22),o(43),t()()(),n(44,"div")(45,"label",16),o(46,"Montant Min (DT)"),t(),n(47,"input",23),h("ngModelChange",function(p){return i.onMinAmountChange(p)}),t()(),n(48,"div")(49,"label",16),o(50,"Montant Max (DT)"),t(),n(51,"input",24),h("ngModelChange",function(p){return i.onMaxAmountChange(p)}),t()()(),n(52,"div",25)(53,"button",26),h("click",function(){return i.clearFilters()}),o(54," R\xE9initialiser Filtres "),t()()(),C(55,ze,44,16,"div",27)(56,We,5,6,"div",28),t()),r&2&&(l(3),m("ngIf",i.errorMessage),l(2),m("ngModel",i.searchTerm),l(8),m("ngIf",!i.showForm),l(),m("ngIf",i.showForm),l(10),m("ngModel",i.selectedCustomer)("items",N(25,17,i.customers$)??R(19,Me))("clearable",!0),l(5),m("ngModel",i.dateFrom),l(4),m("ngModel",i.dateTo),l(4),m("ngModel",i.sortBy),l(2),v("Date ",i.sortBy==="date"?i.sortOrder==="asc"?"\u2191":"\u2193":""),l(2),v("Client ",i.sortBy==="customer"?i.sortOrder==="asc"?"\u2191":"\u2193":""),l(2),v("Montant ",i.sortBy==="amount"?i.sortOrder==="asc"?"\u2191":"\u2193":""),l(4),m("ngModel",i.minAmount),l(4),m("ngModel",i.maxAmount),l(4),m("ngIf",i.showForm),l(),m("ngIf",!i.isLoading))},dependencies:[be,le,he,ge,ne,de,pe,re,oe,se,me,ce,ue,$e,Fe,te,K,X,fe,ae,Z,ee],styles:[".container[_ngcontent-%COMP%]{max-width:1200px}button[_ngcontent-%COMP%]{transition:all .2s}@media (max-width: 768px){table[_ngcontent-%COMP%]{display:block;overflow-x:auto}}"]});let d=c;return d})();export{ut as ExitVoucherComponent};
